<!DOCTYPE html> <html><head>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>TetrisActually</title>
    <style>button {
    padding: 0.5rem;
    font-size: 1rem;
}</style></head>
    <body>
        <canvas id="tetris" tabindex="0"></canvas>
        <br>
        <div>
            <button class="lessR">LESS ROWS </button>
            <button class="moreR">MORE ROWS </button>
            <button class="lessC">LESS COLUMNS </button>
            <button class="moreC">MORE COLUMNS </button>
            <button class="up">UP</button>
            <button class="down">DOWN</button>
            <button class="left">LEFT</button>
            <button class="right">RIGHT</button>
            
            <br>
            
            <button class="t_l">Left</button>
            <button class="t_r">Right</button>
            
        </div>
    
<script>
/*__POPCODESTART__*/
function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

var initialize = function initialize(canvas) {
  var dpr = window.devicePixelRatio || 1;
  var rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  var ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);
  return ctx;
};

var randomProperty = function randomProperty(obj) {
  var keys = Object.keys(obj);
  return obj[keys[keys.length * Math.random() << 0]];
};

var CANVAS_WIDTH = 1080 / 3,
    CANVAS_HEIGHT = 1920 / 3;

var Tetris = function () {
  var _this2 = this;

  var blocksPlaced = new Array();
  var score = 0;
  var cont = {
    x: 60,
    y: 130,
    rows: 15,
    columns: 10,
    squareSize: 20
  };
  var isReady = false;
  var current;

  var Block = /*#__PURE__*/function () {
    "use strict";

    function Block(column, row, type, ctx) {
      _classCallCheck(this, Block);

      this.fillStyle = 'hsl(' + 360 * Math.random() + ', 50%, 50%)';
      this.tetrisTypes = {
        iBlock: [[0, 0], [0, 1], [0, 2], [0, 3]],
        jBlock: [[0, 0], [0, 1], [1, 1], [2, 1]],
        lBlock: [[0, 1], [1, 1], [2, 1], [2, 0]],
        oBlock: [[0, 0], [1, 0], [0, 1], [1, 1]],
        sBlock: [[0, 1], [1, 1], [1, 0], [2, 0]],
        tBlock: [[1, 0], [0, 1], [1, 1], [2, 1]],
        zBlock: [[0, 0], [1, 0], [1, 1], [2, 1]]
      };
      this.current = this.tetrisTypes[type];

      if (type === 'random') {
        this.current = randomProperty(this.tetrisTypes);
      }

      this.dim = this.calcDim();
      this.column = column;
      this.row = row;
      this.ctx = ctx;
      this.isMovable = true;
    }

    _createClass(Block, [{
      key: "calcDim",
      value: function calcDim() {
        var w = 0,
            h = 0;

        for (var i = 0; i < this.current.length; i++) {
          if (w <= this.current[i][0] + 1) {
            w = this.current[i][0] + 1;
          }

          if (h <= this.current[i][1] + 1) {
            h = this.current[i][1] + 1;
          }
        }

        return [w, h];
      }
    }, {
      key: "right",
      value: function right() {
        if (current.column + current.dim[0] < cont.columns) {
          current.column++;
        }

        this.checkCollision();
      }
    }, {
      key: "left",
      value: function left() {
        if (current.column > 0) {
          current.column--;
        }

        this.checkCollision();
      }
    }, {
      key: "down",
      value: function down() {
        if (current.row + current.dim[1] - 1 < cont.rows) {
          current.row++;
        }

        this.checkCollision();
      }
    }, {
      key: "checkCollision",
      value: function checkCollision() {
        var collision = false;

        for (var i = 0; i < blocksPlaced.length; i++) {
          for (var a = 0; a < blocksPlaced[i].current.length; a++) {
            for (var b = 0; b < this.current.length; b++) {
              var column = [this.current[b][0] + this.column, blocksPlaced[i].current[a][0] + blocksPlaced[i].column];
              var row = [this.current[b][1] + this.row, blocksPlaced[i].current[a][0] + blocksPlaced[i].row];

              if (column[0] >= column[1] && row[0] >= row[1]) {
                collision = true;
              }
            }
          }
        }

        if (current.row + current.dim[1] - 1 === cont.rows || collision) {
          blocksPlaced.push(current);
          collision = false;
          current = new Block(4, 0, 'random', ctx);
        }
      }
    }, {
      key: "rotate",
      value: function rotate() {}
    }, {
      key: "render",
      value: function render() {
        var _this = this;

        this.ctx.fillStyle = this.fillStyle;
        this.current.forEach(function (el) {
          _this.ctx.fillRect(cont.x + (el[0] + _this.column) * cont.squareSize, cont.y + (el[1] + _this.row) * cont.squareSize, cont.squareSize, cont.squareSize);
        });
      }
    }]);

    return Block;
  }();

  return {
    cont: cont,
    current: current,
    score: score,
    init: function init(canvas, ctx) {
      current = new Block(4, 0, 'random', ctx);
      var interval_c = setInterval(function () {
        current.down();
      }, 100);
      isReady = true;
      canvas.addEventListener("keydown", function (e) {
        switch (e.key) {
          case 'ArrowRight':
            current.right();
            break;

          case 'ArrowLeft':
            current.left();
            break;

          case 'ArrowDown':
            current.down();
            break;

          case 'ArrowUp':
            current.rotate();
        }
      });
    },
    render: function render(ctx) {
      _this2.ctx = ctx;

      if (isReady) {
        _this2.tile = [];
        _this2.tile.x = 0;
        _this2.tile.y = 0;
        ctx.fillStyle = '#000';

        for (var row = 0; row <= cont.rows; row++) {
          _this2.tile.y = cont.squareSize * row + cont.y;

          for (var column = 0; column < cont.columns; column++) {
            _this2.tile.x = cont.squareSize * column + cont.x;

            _this2.ctx.fillRect(_this2.tile.x, _this2.tile.y, cont.squareSize, cont.squareSize);

            _this2.ctx.strokeRect(_this2.tile.x, _this2.tile.y, cont.squareSize, cont.squareSize);
          }
        }

        if (blocksPlaced) {
          for (var i = 0; i < blocksPlaced.length; i++) {
            blocksPlaced[i].render();
          }
        }

        current.render();
      } else {
        _this2.ctx.textAlign = 'center';

        _this2.ctx.fillText("Loading", CANVAS_WIDTH / 2, CANVAS_HEIGHT / 2);
      }
    }
  };
}();

var main = function () {
  var canvas = document.getElementById("tetris");
  var ctx = initialize(canvas);
  var times = new Array();
  var fps;
  Tetris.init(canvas, ctx);

  var render = function render() {
    ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
    canvas.width = CANVAS_WIDTH;
    canvas.height = CANVAS_HEIGHT;
    ctx.fillStyle = "#aac";
    ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
    ctx.fillStyle = "#000";
    ctx.font = 'bold 15px Verdana';
    ctx.strokeStyle = "#fff";
    ctx.fillText("Broken Tetris", 0, 15);
    ctx.fillText("FPS: ".concat(fps, " Score: ").concat(Tetris.score), 0, 35);

    try {
      Tetris.render(ctx);
    } catch (error) {
      ctx.textAlign = 'center';
      ctx.fillText("".concat(error), CANVAS_WIDTH / 2, CANVAS_HEIGHT / 2);
      throw new Error(error);
    }

    window.requestAnimationFrame(function () {
      var now = performance.now();

      while (times.length > 0 && times[0] <= now - 1000) {
        times.shift();
      }

      times.push(now);
      fps = times.length;
      render();
    });
  };

  return {
    render: render
  };
}();

document.querySelector("button.t_l").addEventListener("mousedown", function () {
  Tetris.init.current.left();
});
document.querySelector("button.t_r").addEventListener("mousedown", function () {
  Tetris.init.current.right();
});
document.querySelector("button.left").addEventListener("mousedown", function () {
  Tetris.cont.x -= 30;
});
document.querySelector("button.right").addEventListener("mousedown", function () {
  Tetris.cont.x += 30;
});
document.querySelector("button.up").addEventListener("mousedown", function () {
  Tetris.cont.y -= 30;
});
document.querySelector("button.down").addEventListener("mousedown", function () {
  Tetris.cont.y += 30;
});
document.querySelector("button.lessR").addEventListener("mousedown", function () {
  Tetris.cont.rows -= 1;
});
document.querySelector("button.moreR").addEventListener("mousedown", function () {
  Tetris.cont.rows += 1;
});
document.querySelector("button.lessC").addEventListener("mousedown", function () {
  Tetris.cont.columns -= 1;
});
document.querySelector("button.moreC").addEventListener("mousedown", function () {
  Tetris.cont.columns += 1;
});
document.body.onload = main.render();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBvcGNvZGVQcmV2aWV3LmpzIl0sIm5hbWVzIjpbImluaXRpYWxpemUiLCJjYW52YXMiLCJkcHIiLCJ3aW5kb3ciLCJkZXZpY2VQaXhlbFJhdGlvIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIndpZHRoIiwiaGVpZ2h0IiwiY3R4IiwiZ2V0Q29udGV4dCIsInNjYWxlIiwicmFuZG9tUHJvcGVydHkiLCJvYmoiLCJrZXlzIiwiT2JqZWN0IiwibGVuZ3RoIiwiTWF0aCIsInJhbmRvbSIsIkNBTlZBU19XSURUSCIsIkNBTlZBU19IRUlHSFQiLCJUZXRyaXMiLCJibG9ja3NQbGFjZWQiLCJBcnJheSIsInNjb3JlIiwiY29udCIsIngiLCJ5Iiwicm93cyIsImNvbHVtbnMiLCJzcXVhcmVTaXplIiwiaXNSZWFkeSIsImN1cnJlbnQiLCJCbG9jayIsImNvbHVtbiIsInJvdyIsInR5cGUiLCJmaWxsU3R5bGUiLCJ0ZXRyaXNUeXBlcyIsImlCbG9jayIsImpCbG9jayIsImxCbG9jayIsIm9CbG9jayIsInNCbG9jayIsInRCbG9jayIsInpCbG9jayIsImRpbSIsImNhbGNEaW0iLCJpc01vdmFibGUiLCJ3IiwiaCIsImkiLCJjaGVja0NvbGxpc2lvbiIsImNvbGxpc2lvbiIsImEiLCJiIiwicHVzaCIsImZvckVhY2giLCJlbCIsImZpbGxSZWN0IiwiaW5pdCIsImludGVydmFsX2MiLCJzZXRJbnRlcnZhbCIsImRvd24iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImtleSIsInJpZ2h0IiwibGVmdCIsInJvdGF0ZSIsInJlbmRlciIsInRpbGUiLCJzdHJva2VSZWN0IiwidGV4dEFsaWduIiwiZmlsbFRleHQiLCJtYWluIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRpbWVzIiwiZnBzIiwiY2xlYXJSZWN0IiwiZm9udCIsInN0cm9rZVN0eWxlIiwiZXJyb3IiLCJFcnJvciIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm5vdyIsInBlcmZvcm1hbmNl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QXhELEVBQXFFLFlBQU07QUFDdkUzQyxFQUFBQSxNQUFNLENBQUNJLElBQVAsQ0FBWUcsSUFBWixJQUFvQixDQUFwQjtBQUNILENBRkQ7QUFLQWdELFFBQVEsQ0FBQ2EsYUFBVCxDQUF1QixjQUF2QixFQUF1Q3pCLGdCQUF2QyxDQUF3RCxXQUF4RCxFQUFxRSxZQUFNO0FBQ3ZFM0MsRUFBQUEsTUFBTSxDQUFDSSxJQUFQLENBQVlJLE9BQVosSUFBdUIsQ0FBdkI7QUFDSCxDQUZEO0FBR0ErQyxRQUFRLENBQUNhLGFBQVQsQ0FBdUIsY0FBdkIsRUFBdUN6QixnQkFBdkMsQ0FBd0QsV0FBeEQsRUFBcUUsWUFBTTtBQUN2RTNDLEVBQUFBLE1BQU0sQ0FBQ0ksSUFBUCxDQUFZSSxPQUFaLElBQXVCLENBQXZCO0FBQ0gsQ0FGRDtBQUlBK0MsUUFBUSxDQUFDYyxJQUFULENBQWNDLE1BQWQsR0FBdUJoQixJQUFJLENBQUNMLE1BQUwsRUFBdkIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpbml0aWFsaXplID0gKGNhbnZhcykgPT4ge1xuICAgIGxldCBkcHIgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgIGxldCByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNhbnZhcy53aWR0aCA9IHJlY3Qud2lkdGggKiBkcHI7XG4gICAgY2FudmFzLmhlaWdodCA9IHJlY3QuaGVpZ2h0ICogZHByO1xuICAgIGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjdHguc2NhbGUoZHByLCBkcHIpO1xuICAgIHJldHVybiBjdHg7XG59O1xuXG52YXIgcmFuZG9tUHJvcGVydHkgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmopO1xuICAgIHJldHVybiBvYmpba2V5c1sga2V5cy5sZW5ndGggKiBNYXRoLnJhbmRvbSgpIDw8IDBdXTtcbn07XG5cbmxldCBDQU5WQVNfV0lEVEggPSAxMDgwIC8gMyxcbiAgICBDQU5WQVNfSEVJR0hUID0gMTkyMCAvIDM7XG5cbmxldCBUZXRyaXMgPSAoZnVuY3Rpb24oKSB7XG4gICAgbGV0IGJsb2Nrc1BsYWNlZCA9IG5ldyBBcnJheSgpO1xuICAgIGxldCBzY29yZSA9IDA7XG4gICAgbGV0IGNvbnQgPSB7XG4gICAgICAgIHg6IDYwLFxuICAgICAgICB5OiAxMzAsXG4gICAgICAgIHJvd3M6IDE1LFxuICAgICAgICBjb2x1bW5zOiAxMCxcbiAgICAgICAgc3F1YXJlU2l6ZTogMjBcbiAgICB9O1xuICAgIGxldCBpc1JlYWR5ID0gZmFsc2U7XG4gICAgbGV0IGN1cnJlbnQ7XG4gICAgXG4gICAgY2xhc3MgQmxvY2sge1xuICAgICAgICAgICAgY29uc3RydWN0b3IoY29sdW1uLCByb3csIHR5cGUsIGN0eCkge1xuICAgICAgICAgICAgdGhpcy5maWxsU3R5bGUgPSAnaHNsKCcgKyAzNjAgKiBNYXRoLnJhbmRvbSgpICsgJywgNTAlLCA1MCUpJztcbiAgICAgICAgICAgIHRoaXMudGV0cmlzVHlwZXMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlCbG9jazogW1xuICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDNdLFxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBqQmxvY2s6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFswLDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzAsMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbMSwxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFsyLDFdXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIGxCbG9jazogW1xuICAgICAgICAgICAgICAgICAgICBcdFswLDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzEsMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbMiwxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFsyLDBdLFxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBvQmxvY2s6IFtcbiAgICAgICAgICAgICAgICAgICAgXHRbMCwwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFsxLDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzAsMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbMSwxXVxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBzQmxvY2s6IFtcbiAgICAgICAgICAgICAgICAgICAgXHRbMCwxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFsxLDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzEsMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbMiwwXVxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICB0QmxvY2s6IFtcbiAgICAgICAgICAgICAgICAgICAgXHRbMSwwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFswLDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzEsMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbMiwxXVxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICB6QmxvY2s6IFtcbiAgICAgICAgICAgICAgICAgICAgXHRbMCwwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFsxLDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgWzEsMV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBbMiwxXVxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy50ZXRyaXNUeXBlc1t0eXBlXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3JhbmRvbScpIHtcbiAgICAgICAgICAgICAgICBcdHRoaXMuY3VycmVudCA9IHJhbmRvbVByb3BlcnR5KHRoaXMudGV0cmlzVHlwZXMpO1xuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuZGltID0gdGhpcy5jYWxjRGltKCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5jb2x1bW4gPSBjb2x1bW47XG4gICAgICAgICAgICAgICAgdGhpcy5yb3cgPSByb3c7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5jdHggPSBjdHg7XG4gICAgICAgICAgICAgICAgdGhpcy5pc01vdmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXHRcbiAgICAgICAgXG4gICAgICAgICAgICBjYWxjRGltKCkge1xuICAgICAgICAgICAgICAgIGxldCB3ID0gMCwgaCA9IDA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmN1cnJlbnQubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHcgPD0gdGhpcy5jdXJyZW50W2ldWzBdICsgMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdyA9IHRoaXMuY3VycmVudFtpXVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChoIDw9IHRoaXMuY3VycmVudFtpXVsxXSArIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGggPSB0aGlzLmN1cnJlbnRbaV1bMV0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt3LCBoXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgICByaWdodCgpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5jb2x1bW4gKyBjdXJyZW50LmRpbVswXSA8IGNvbnQuY29sdW1ucykge1xuICAgICAgICAgICAgICAgIFx0Y3VycmVudC5jb2x1bW4rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGVmdCgpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5jb2x1bW4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuY29sdW1uLS07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja0NvbGxpc2lvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXHRkb3duKCkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LnJvdyArIGN1cnJlbnQuZGltWzFdIC0gMSA8IGNvbnQucm93cykge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnJvdysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrQ29sbGlzaW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgXHRjaGVja0NvbGxpc2lvbigpIHtcbiAgICAgICAgICAgICAgICBsZXQgY29sbGlzaW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja3NQbGFjZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBcdGZvciAobGV0IGEgPSAwOyBhIDwgYmxvY2tzUGxhY2VkW2ldLmN1cnJlbnQubGVuZ3RoOyBhKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGIgPSAwOyBiIDwgdGhpcy5jdXJyZW50Lmxlbmd0aDsgYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbiA9IFt0aGlzLmN1cnJlbnRbYl1bMF0gKyB0aGlzLmNvbHVtbiwgYmxvY2tzUGxhY2VkW2ldLmN1cnJlbnRbYV1bMF0gKyBibG9ja3NQbGFjZWRbaV0uY29sdW1uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcm93ID0gW3RoaXMuY3VycmVudFtiXVsxXSArIHRoaXMucm93LCAgYmxvY2tzUGxhY2VkW2ldLmN1cnJlbnRbYV1bMF0gKyBibG9ja3NQbGFjZWRbaV0ucm93XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFx0aWYoY29sdW1uWzBdID49IGNvbHVtblsxXSAmJiByb3dbMF0gPj0gcm93WzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHRjb2xsaXNpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXHR9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQucm93ICsgY3VycmVudC5kaW1bMV0gLSAxID09PSBjb250LnJvd3MgfHwgY29sbGlzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGJsb2Nrc1BsYWNlZC5wdXNoKGN1cnJlbnQpO1xuICAgICAgICAgICAgICAgICAgICBjb2xsaXNpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IG5ldyBCbG9jayg0LDAsICdyYW5kb20nLCBjdHgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIFx0cm90YXRlKCkge1xuXHRcdFx0XHRcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVuZGVyKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbFN0eWxlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudC5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgICAgICAgICBcdHRoaXMuY3R4LmZpbGxSZWN0KGNvbnQueCArIChlbFswXSArIHRoaXMuY29sdW1uKSAqIGNvbnQuc3F1YXJlU2l6ZSwgY29udC55ICsgKGVsWzFdICsgdGhpcy5yb3cpICogY29udC5zcXVhcmVTaXplLCBjb250LnNxdWFyZVNpemUsIGNvbnQuc3F1YXJlU2l6ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGNvbnQsXG4gICAgICAgIGN1cnJlbnQsXG4gICAgICAgIHNjb3JlLFxuICAgICAgICBpbml0OiAoY2FudmFzLCBjdHgpID0+IHtcbiAgICAgICAgICAgIGN1cnJlbnQgPSBuZXcgQmxvY2soNCwgMCwgJ3JhbmRvbScsIGN0eCk7XG4gICAgICAgICAgICBsZXQgaW50ZXJ2YWxfYyA9IHNldEludGVydmFsKCAoKSA9PiB7XG5cdFx0XHRcdGN1cnJlbnQuZG93bigpO1xuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaXNSZWFkeSA9IHRydWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgXHRzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5yaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmxlZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5kb3duKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnJvdGF0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICByZW5kZXI6IChjdHgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY3R4ID0gY3R4O1xuICAgICAgICAgICAgaWYgKGlzUmVhZHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbGUgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLnRpbGUueCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy50aWxlLnkgPSAwO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgXHRjdHguZmlsbFN0eWxlID0gJyMwMDAnO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDw9IGNvbnQucm93czsgcm93KyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aWxlLnkgPSBjb250LnNxdWFyZVNpemUgKiByb3cgKyBjb250Lnk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY29sdW1uID0gMDsgY29sdW1uIDwgY29udC5jb2x1bW5zOyBjb2x1bW4rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50aWxlLnggPSBjb250LnNxdWFyZVNpemUgKiBjb2x1bW4gKyBjb250Lng7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN0eC5maWxsUmVjdCh0aGlzLnRpbGUueCwgdGhpcy50aWxlLnksIGNvbnQuc3F1YXJlU2l6ZSwgY29udC5zcXVhcmVTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3R4LnN0cm9rZVJlY3QodGhpcy50aWxlLngsIHRoaXMudGlsZS55LCBjb250LnNxdWFyZVNpemUsIGNvbnQuc3F1YXJlU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGJsb2Nrc1BsYWNlZCkge1xuICAgICAgICAgICAgICAgIFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja3NQbGFjZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcdGJsb2Nrc1BsYWNlZFtpXS5yZW5kZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyZW50LnJlbmRlcigpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxUZXh0KGBMb2FkaW5nYCwgQ0FOVkFTX1dJRFRIIC8gMiwgQ0FOVkFTX0hFSUdIVCAvIDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn0pKCk7XG5cbmxldCBtYWluID0gKGZ1bmN0aW9uKCkge1xuICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRldHJpc1wiKTtcbiAgICBsZXQgY3R4ID0gaW5pdGlhbGl6ZShjYW52YXMpO1xuICAgIGNvbnN0IHRpbWVzID0gbmV3IEFycmF5KCk7XG4gICAgbGV0IGZwcztcblxuICAgIFRldHJpcy5pbml0KGNhbnZhcywgY3R4KTtcblxuICAgIGxldCByZW5kZXIgPSAoKSA9PiB7XG4gICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgQ0FOVkFTX1dJRFRILCBDQU5WQVNfSEVJR0hUKTtcblxuICAgICAgICBjYW52YXMud2lkdGggPSBDQU5WQVNfV0lEVEg7XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBDQU5WQVNfSEVJR0hUO1xuXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiNhYWNcIjtcbiAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIENBTlZBU19XSURUSCwgQ0FOVkFTX0hFSUdIVCk7XG5cbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiIzAwMFwiO1xuICAgICAgICBjdHguZm9udCA9ICdib2xkIDE1cHggVmVyZGFuYSc7XG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiI2ZmZlwiO1xuICAgICAgICBjdHguZmlsbFRleHQoYEJyb2tlbiBUZXRyaXNgLCAwLCAxNSk7XG4gICAgICAgIGN0eC5maWxsVGV4dChgRlBTOiAke2Zwc30gU2NvcmU6ICR7VGV0cmlzLnNjb3JlfWAsIDAsIDM1KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgVGV0cmlzLnJlbmRlcihjdHgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGAke2Vycm9yfWAsIENBTlZBU19XSURUSCAvIDIsIENBTlZBU19IRUlHSFQgLyAyKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgICAgIHdoaWxlICh0aW1lcy5sZW5ndGggPiAwICYmIHRpbWVzWzBdIDw9IG5vdyAtIDEwMDApIHtcbiAgICAgICAgICAgICAgICB0aW1lcy5zaGlmdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGltZXMucHVzaChub3cpO1xuICAgICAgICAgICAgZnBzID0gdGltZXMubGVuZ3RoO1xuICAgICAgICAgICAgcmVuZGVyKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXJcbiAgICB9O1xufSkoKTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi50X2xcIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB7XG4gICAgVGV0cmlzLmluaXQuY3VycmVudC5sZWZ0KCk7XG59KTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJidXR0b24udF9yXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKCkgPT4ge1xuICAgIFRldHJpcy5pbml0LmN1cnJlbnQucmlnaHQoKTtcbn0pO1xuXG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJidXR0b24ubGVmdFwiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICBUZXRyaXMuY29udC54IC09IDMwO1xufSk7XG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uLnJpZ2h0XCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKCkgPT4ge1xuICAgIFRldHJpcy5jb250LnggKz0gMzA7XG59KTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi51cFwiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICBUZXRyaXMuY29udC55IC09IDMwO1xufSk7XG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uLmRvd25cIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB7XG4gICAgVGV0cmlzLmNvbnQueSArPSAzMDtcbn0pO1xuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi5sZXNzUlwiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICBUZXRyaXMuY29udC5yb3dzIC09IDE7XG59KTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJidXR0b24ubW9yZVJcIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB7XG4gICAgVGV0cmlzLmNvbnQucm93cyArPSAxO1xufSk7XG5cblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi5sZXNzQ1wiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICBUZXRyaXMuY29udC5jb2x1bW5zIC09IDE7XG59KTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJidXR0b24ubW9yZUNcIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB7XG4gICAgVGV0cmlzLmNvbnQuY29sdW1ucyArPSAxO1xufSk7XG5cbmRvY3VtZW50LmJvZHkub25sb2FkID0gbWFpbi5yZW5kZXIoKTsiXX0=</script></body></html>